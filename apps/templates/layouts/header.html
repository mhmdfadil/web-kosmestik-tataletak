<!-- Header bar -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    .profile-icon {
        cursor: pointer;
        transition: transform 0.3s ease;
    }
    
    .profile-icon:hover {
        transform: scale(1.1);
    }

    #profileImg {
        cursor: pointer;
        transition: transform 0.3s ease;
    }
    
    #profileImg:hover {
        transform: scale(1.1);
    }
    
    .profile-dropdown {
        position: absolute;
        top: calc(100% + 10px);
        right: 0;
        width: 250px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.3s ease;
        z-index: 1000;
    }
    
    .profile-dropdown.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }
    
    /* Tambahkan segitiga/pointer di atas dropdown */
    .profile-dropdown::before {
        content: '';
        position: absolute;
        top: -10px;
        right: 12px;
        width: 0;
        height: 0;
        border-left: 10px solid transparent;
        border-right: 10px solid transparent;
        border-bottom: 10px solid white;
    }
    
    .profile-dropdown-item {
        display: flex;
        align-items: center;
        padding: 12px 15px;
        color: #333;
        text-decoration: none;
        transition: background-color 0.2s;
    }
    
    .profile-dropdown-item:hover {
        background-color: #f5f5f5;
    }
    
    .profile-dropdown-item svg {
        width: 20px;
        height: 20px;
        margin-right: 10px;
        color: #555;
    }
    
    .menu-button {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
        transition: background-color 0.3s;
    }
    
    .menu-button:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }
</style>

<header class="text-white flex items-center justify-between px-6 py-4">
    <button class="menu-button" id="menuToggle">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
    </button>
    <div class="flex-1 flex justify-center">
        <h1 class="text-2xl md:text-3xl font-bold select-none">{{ header_title if header_title else 'Dashboard' }}</h1>
    </div>
    <div class="relative">
        {% if user and user[6] %}
            <div class="mx-3" id="profileImg" title="User Profile" aria-label="User Profile Icon" role="img">
                <img src="{{ url_for('static', filename='images/' + user[6]) }}" 
                    alt="Profile Image" class="w-[45px] h-[45px] rounded-full">
            </div>
        {% else %}
            <div class="profile-icon mx-3" id="profileIcon" title="User Profile" aria-label="User Profile Icon" role="img">
                <svg xmlns="http://www.w3.org/2000/svg" fill="white" viewBox="0 0 24 24" class="w-6 h-6">
                    <circle cx="12" cy="8" r="4"/>
                    <path d="M4 20c0-4 8-4 8-4s8 0 8 4v2H4v-2z"/>
                </svg>
            </div>
        {% endif %}
        
        <!-- Dropdown menu -->      
        <div class="profile-dropdown" id="profileDropdown">
            <div class="profile-dropdown-item border-b border-gray-300 flex items-center">
                {% if user and user[6] %}
                    <img src="{{ url_for('static', filename='images/' + user[6]) }}" 
                        alt="Profile Image" class="w-8 h-8 rounded-full mr-3">
                {% else %}
                    <i class="fas fa-user-circle text-teal-500 mr-3" style="font-size: 27px;"></i>
                {% endif %}
                <span style="font-size: 14px; font-weight: 600;">{{ user[3] }}</span>
            </div>

            <a href="{{ url_for('routes.profile') }}" class="profile-dropdown-item">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                Profil Saya
            </a>
            
            <div class="profile-dropdown-item">
                <a href="{{ url_for('routes.logout') }}" class="flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    Keluar
                </a>
            </div>
        </div>
    </div>
</header>

<script>
    // JavaScript untuk toggle dropdown
    document.addEventListener('DOMContentLoaded', function() {
        // Cek elemen mana yang ada (profileIcon atau profileImg)
        const profileTrigger = document.getElementById('profileIcon') || document.getElementById('profileImg');
        const profileDropdown = document.getElementById('profileDropdown');
        
        if (profileTrigger) {
            profileTrigger.addEventListener('click', function() {
                profileDropdown.classList.toggle('active');
            });
            
            // Tutup dropdown ketika klik di luar
            document.addEventListener('click', function(event) {
                if (!profileTrigger.contains(event.target) && !profileDropdown.contains(event.target)) {
                    profileDropdown.classList.remove('active');
                }
            });
        }
    });
</script>